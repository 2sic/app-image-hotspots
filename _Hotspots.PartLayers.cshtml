@inherits Custom.Hybrid.Razor12
@using ToSic.Razor.Blade;
@using ToSic.Sxc.Services;
@{
  var hotspotsSettings = DynamicModel.HotspotsSettings;

  // Image Service used to generate optimal images
  var imgSvc = GetService<IImageService>();
}
@* This creates the hidden layers which will appear when hotspots are clicked *@
@foreach (var hotspot in hotspotsSettings.Hotspots) {
  var imgIsAbove = hotspot.OverlayLayout == "img/text"; // alternative is img-text
  var layoutClass = imgIsAbove ? "" : "display-flex-row";

  // Set image height / width based on layout type
  var imageWidth = (int)hotspotsSettings.OverlayImageMaxWidth * (imgIsAbove ? 1 : 0.75);
  var imageHeight = (int)hotspotsSettings.OverlayImageMaxHeight * (imgIsAbove ? 0.7 : 1 );

  var toolbar = Content.IsDemoItem ? "" : Edit.TagToolbar(hotspot, toolbar: new[] { "%delete&show=true" });
  <div id="hotspot3-content-@hotspot.EntityId-@CmsContext.Module.Id" class="hotspot3-fancybox-content" style="display: none" @toolbar>
    <div class="@layoutClass">
      @if(Text.Has(hotspot.Image)) {
        <div>
          @{
            var altText = Text.First(hotspot.Field("Image").Metadata.Description, hotspot.Title);
            var pic = imgSvc.Picture(hotspot.Field("Image"), settings: Settings.Images.Lightbox, width: imageWidth, imgAlt: altText);
            pic.Img.Height(imageHeight.ToString());
          }
          @pic
        </div>
      }

      @if(Text.Has(hotspot.Description)) {
        <div class="hotspot3-fancybox-text">
          @Html.Raw(hotspot.Description)
        </div>
      }
    </div>
  </div>
}